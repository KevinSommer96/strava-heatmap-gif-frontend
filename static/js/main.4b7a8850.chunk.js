(this["webpackJsonpstrava-plot-frontend"]=this["webpackJsonpstrava-plot-frontend"]||[]).push([[0],{112:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(52),c=n.n(r),l=(n(73),n(15)),i=n(3),u=n(21),m=n(2),h=Object(a.createContext)(),s=function(){return Object(a.useContext)(h)},f=n(1);function d(){var e=Object(i.a)(["\n  width: 100%;\n  max-width: 30%;\n  height: 1.5em;\n  font-weight: 700;\n  background-color: ",";\n  border: 1px solid ",";\n  border-radius: 0.2em;\n  color: ",";\n  text-align: center;\n  text-decoration: none;\n  box-shadow: none;\n  font-size: inherit;\n  position: relative;\n  margin: 10px 0;\n  transition: color 0.2s ease-in;\n  transition: border 0.2s ease-in;\n\n  :hover {\n    border: 1px solid ",";\n    color: ",";\n    box-shadow: none;\n  }\n"]);return d=function(){return e},e}function g(){var e=Object(i.a)(["\n  margin: 0 auto;\n  padding: 0.5em 0;\n"]);return g=function(){return e},e}function p(){var e=Object(i.a)(["\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n"]);return p=function(){return e},e}function b(){var e=Object(i.a)(["\n  display: flex;\n  width: 70%;\n  margin: 0 auto;\n  background-color: transparent;\n  color: ",";\n"]);return b=function(){return e},e}var v=f.b.div(b(),(function(e){return e.theme.colorHighlight})),E=f.b.div(p()),j=f.b.h1(g()),O=f.b.button(d(),(function(e){return e.theme.colorBackground}),(function(e){return e.theme.colorHighlight}),(function(e){return e.theme.colorHighlight}),(function(e){return e.theme.colorVermillion}),(function(e){return e.theme.colorVermillion})),k=n(54),x=n.n(k),w=n(55),y=n.n(w);function C(){var e=Object(i.a)(["\n  width: 50vw;\n  margin: 0 auto;\n  margin-bottom: 2rem;\n  border: 1px solid ",";\n"]);return C=function(){return e},e}var M=f.b.img(C(),(function(e){return e.theme.colorHighlight})),S=function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(v,null,o.a.createElement(j,null,"Generate Heatmap Gifs of Strava Activities")),o.a.createElement(v,null,o.a.createElement(M,{src:y.a,alt:"map"})),o.a.createElement(v,null,o.a.createElement(M,{src:x.a,alt:"gif"})))},H=n(18),T=n.n(H),A=n(19),z=n.n(A),R=function(){var e=s(),t=e.authToken,n=e.setAuthToken;return Object(a.useEffect)((function(){t?n(null):T.a.get("".concat("http://localhost:8000")).then((function(e){return window.location.replace(e.data.url)}))}),[t,n]),o.a.createElement(E,null,o.a.createElement(z.a,{size:150}))},_=n(10);function B(){var e=Object(i.a)(["\n  margin: 0 auto;\n  color: ",";\n  font-size: 150%;\n  text-decoration: none;\n\n  :hover {\n    color: ",";\n    text-decoration: none;\n  }\n"]);return B=function(){return e},e}function F(){var e=Object(i.a)(["\n  display: block;\n  margin: 0 auto;\n  border: 1px solid ",";\n"]);return F=function(){return e},e}function I(){var e=Object(i.a)(["\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n"]);return I=function(){return e},e}var L=f.b.div(I()),N=f.b.img(F(),(function(e){return e.theme.colorHighlight})),J=f.b.a(B(),(function(e){return e.theme.colorHighlight}),(function(e){return e.theme.colorLimeLight})),W=function(e){var t=s().authToken,n=e.location.state.coords;console.log("coords",e.location.state.coords);var r=Object(a.useState)(void 0),c=Object(l.a)(r,2),i=c[0],u=c[1];return Object(a.useEffect)((function(){var a=n.map((function(e){return e[0]})),o=n.map((function(e){return e[1]}));0!==n.length&&T.a.get("".concat("http://localhost:8000","/gif/"),{params:{access_token:t,min_lon:Math.min.apply(Math,Object(_.a)(a)),max_lat:Math.max.apply(Math,Object(_.a)(o)),max_lon:Math.max.apply(Math,Object(_.a)(a)),min_lat:Math.min.apply(Math,Object(_.a)(o)),ratio:e.location.state.ratio,colour:e.location.state.colour,backgroundColour:e.location.state.backgroundColour,alpha:e.location.state.alpha}}).then((function(e){return u(e.data.gif)}))}),[t,n,e.location.state]),o.a.createElement("div",null,i?o.a.createElement(o.a.Fragment,null,o.a.createElement(v,null,o.a.createElement(j,null,"Result")),o.a.createElement(N,{src:"data:image/gif;base64,"+i,alt:"ok"}),o.a.createElement(v,{style:{padding:"1.5em 0"}},o.a.createElement(J,{href:"data:image/gif;base64,"+i,download:!0},"Download"))):o.a.createElement(L,null,o.a.createElement(z.a,{size:200})))},P=function(){var e=s(),t=e.authToken,n=e.setAuthToken;return Object(a.useEffect)((function(){var e=new URLSearchParams(window.location.search).get("code");e&&T.a.get("".concat("http://localhost:8000","/authorised/"),{params:{code:e}}).then((function(e){return n(e.data.access_token)}))}),[n]),t?o.a.createElement(m.a,{to:"/map"}):o.a.createElement(E,null,o.a.createElement(z.a,{size:150}))},D=n(41),G=n(37),V=n.n(G),q=n(40),Y=(n(110),n(63)),U=n.n(Y),Z=n(66),$=n(39);function K(){var e=Object(i.a)(["\n  width: 20%;\n  height: 100%;\n"]);return K=function(){return e},e}function Q(){var e=Object(i.a)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  margin-bottom: 0.3em;\n  height: 1em;\n"]);return Q=function(){return e},e}function X(){var e=Object(i.a)(["\n  display: flex;\n  flex-direction: column;\n  width: 30%;\n  margin: 1em auto;\n  font-size: 150%;\n"]);return X=function(){return e},e}var ee=f.b.form(X()),te=f.b.div(Q()),ne=f.b.input(K()),ae={width:"60vw",height:"65vh",margin:"0 auto"},oe=function(e){var t=$.toMercator($.multiPoint(e)).geometry.coordinates,n=t.map((function(e){return e[0]})),a=t.map((function(e){return e[1]})),o=Math.min.apply(Math,Object(_.a)(n)),r=Math.max.apply(Math,Object(_.a)(a)),c=Math.max.apply(Math,Object(_.a)(n));return(r-Math.min.apply(Math,Object(_.a)(a)))/(c-o)},re=function(){var e=Object(a.useState)(null),t=Object(l.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)([7.36,50.21]),i=Object(l.a)(c,2),u=i[0],h=i[1],s=Object(a.useState)([]),f=Object(l.a)(s,2),d=f[0],g=f[1],p=Object(a.useRef)(null),b=Object(a.useState)(!1),E=Object(l.a)(b,2),k=E[0],x=E[1],w=Object(Z.a)({initialValues:{colour:"#d9381e",backgroundColour:"#1a1a1d",mapType:"none",alpha:.5},onSubmit:function(e){0!==d.length&&x(!0)}});return navigator.geolocation.getCurrentPosition((function(e){h([e.coords.longitude,e.coords.latitude])})),Object(a.useEffect)((function(){V.a.accessToken="pk.eyJ1Ijoic2xpbWtldmtldiIsImEiOiJja2doMmtsNmkxNnhtMnhzNHhuYjRkY3Z1In0.r6hj4mAPqq28OdkntHMWrA";n||function(e){var t=e.setMap,n=e.mapContainer,a=new V.a.Map({container:n.current,style:"mapbox://styles/mapbox/streets-v11",center:u,zoom:10}),o=new q.a({displayControlsDefault:!1,modes:Object(D.a)(Object(D.a)({},q.a.modes),{},{DRAW_RECTANGLE:U.a})});a.addControl(o,"top-left"),o.changeMode("DRAW_RECTANGLE"),a.on("draw.create",(function(e){console.log("feature",e),console.log(o.get(e.features[0].id)),g(e.features[0].geometry.coordinates[0])})),a.on("load",(function(){t(a),a.resize()}))}({setMap:r,mapContainer:p})}),[n,u]),o.a.createElement(o.a.Fragment,null,k?o.a.createElement(m.a,{to:{pathname:"/gif",state:{coords:d,ratio:oe(d),colour:w.values.colour,backgroundColour:w.values.backgroundColour,alpha:w.values.alpha}}}):o.a.createElement(v,null,o.a.createElement(j,null,"Select a Region")),o.a.createElement("div",{ref:function(e){return p.current=e},style:ae}),o.a.createElement(ee,{onSubmit:w.handleSubmit},o.a.createElement(te,null,o.a.createElement("label",{htmlFor:"colour"},"Colour"),o.a.createElement(ne,{id:"colour",name:"colour",type:"color",onChange:w.handleChange,value:w.values.colour})),o.a.createElement(te,null,o.a.createElement("label",{htmlFor:"backgroundColour"},"Background Colour"),o.a.createElement(ne,{id:"backgroundColour",name:"backgroundColour",type:"color",onChange:w.handleChange,value:w.values.backgroundColour})),o.a.createElement(te,null,o.a.createElement("label",{htmlFor:"alpha"},"Alpha"),o.a.createElement(ne,{type:"number",id:"alpha",name:"alpha",min:"0",max:"1",step:"0.1",onChange:w.handleChange,value:w.values.alpha})),o.a.createElement(te,null,o.a.createElement(O,{onClick:function(){r(null),g([]),w.resetForm()}},"Reset"),o.a.createElement(O,{type:"submit"},"Submit"))))};function ce(){var e=Object(i.a)(["\n  width: 70%;\n  margin: 0 auto;\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-start;\n"]);return ce=function(){return e},e}function le(){var e=Object(i.a)(["\n  color: ",";\n  text-decoration: none;\n  font-weight: 700;\n  height: 6vh;\n  line-height: 6vh;\n  font-size: 2em;\n  text-align: center;\n  overflow: auto;\n  width: 10%;\n"]);return le=function(){return e},e}function ie(){var e=Object(i.a)(["\n  top: 0;\n  width: 100%;\n\n  background-color: rgba(0, 0, 0, 0.5);\n  height: 6vh;\n"]);return ie=function(){return e},e}var ue=f.b.div(ie()),me=f.b.a(le(),(function(e){return e.theme.colorHighlight})),he=f.b.div(ce()),se=function(){return o.a.createElement(ue,null,o.a.createElement(he,null,o.a.createElement(me,{href:"/"},"Home"),o.a.createElement(me,{href:"/map"},"Map")))},fe=n(67);var de=function(e){var t=e.component,n=Object(fe.a)(e,["component"]),a=s().authToken;return o.a.createElement(m.b,Object.assign({},n,{render:function(e){return a?o.a.createElement(t,e):o.a.createElement(m.a,{to:"/code"})}}))},ge={colorBackground:"#1a1a1d",colorHighlight:"#8ee4af",colorLimeLight:"#edf5e1",colorVermillion:"#d9381e",colorBrown:"#907163"};function pe(){var e=Object(i.a)(["\n  color: ",";\n  background: ",";\n  background-repeat: repeat;\n  min-height: 100vh;\n"]);return pe=function(){return e},e}var be=f.b.div(pe(),(function(e){return e.theme.colorHighlight}),(function(e){return e.theme.colorBackground})),ve=function(){var e=JSON.parse(localStorage.getItem("token")),t=Object(a.useState)(e),n=Object(l.a)(t,2),r=n[0],c=n[1];return o.a.createElement(f.a,{theme:ge},o.a.createElement(be,null,o.a.createElement(se,null),o.a.createElement(h.Provider,{value:{authToken:r,setAuthToken:function(e){localStorage.setItem("token",JSON.stringify(e)),c(e)}}},o.a.createElement(u.a,null,o.a.createElement(m.b,{exact:!0,path:"/",component:S}),o.a.createElement(m.b,{path:"/code",component:R}),o.a.createElement(m.b,{path:"/authorised",component:P}),o.a.createElement(de,{path:"/map",component:re}),o.a.createElement(de,{path:"/gif",component:W})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(ve,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},54:function(e,t,n){e.exports=n.p+"static/media/gif.207e1bd0.png"},55:function(e,t,n){e.exports=n.p+"static/media/map.f05de17a.png"},68:function(e,t,n){e.exports=n(112)},73:function(e,t,n){}},[[68,1,2]]]);
//# sourceMappingURL=main.4b7a8850.chunk.js.map